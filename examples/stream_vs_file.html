

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comparing RHD File Data to Live TCP Stream &mdash; python-intan 0.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=47de8214"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="intan" href="../intan_api/modules.html" />
    <link rel="prev" title="Live Plotting of Multiple EMG Channels" href="live_plotting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            python-intan
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="file_loading.html">File Loading and Visualization Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="live_plotting.html">Live Plotting of Multiple EMG Channels</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Comparing RHD File Data to Live TCP Stream</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intan_api/modules.html">intan</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">python-intan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Examples</a></li>
      <li class="breadcrumb-item active">Comparing RHD File Data to Live TCP Stream</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/stream_vs_file.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="comparing-rhd-file-data-to-live-tcp-stream">
<h1>Comparing RHD File Data to Live TCP Stream<a class="headerlink" href="#comparing-rhd-file-data-to-live-tcp-stream" title="Link to this heading"></a></h1>
<p>This example demonstrates how to compare the data recorded to an Intan <cite>.rhd</cite> file with data streamed in real time over TCP from the same device and channel.
This is useful for verifying that your live streaming pipeline matches the saved data and for troubleshooting.</p>
<p><strong>Requirements:</strong>
- A recent <cite>.rhd</cite> data file recorded with the Intan RHX system
- The same Intan RHX Controller device available for TCP streaming
- <cite>matplotlib</cite> for plotting</p>
<p><strong>You’ll see how to:</strong>
- Connect to the RHX device and stream from a selected channel
- Load a <cite>.rhd</cite> file and extract a matching data segment
- Plot and visually compare both traces</p>
<hr class="docutils" />
<p><strong>Example code:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example: Compare saved .rhd file data to live TCP streamed data from Intan RHX.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">intan.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_rhd_file</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">intan.rhx_interface</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntanRHXDevice</span><span class="p">,</span> <span class="n">config_options</span>

<span class="c1"># === Config ===</span>
<span class="n">SAMPLES_TO_COMPARE</span> <span class="o">=</span> <span class="mi">8000</span>    <span class="c1"># Number of samples to compare (e.g., 2 seconds at 4 kHz)</span>
<span class="n">CHANNEL_INDEX</span> <span class="o">=</span> <span class="mi">15</span>           <span class="c1"># Channel to compare</span>

<span class="c1"># --- 1. Stream data live from RHX device ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connecting to RHX TCP client...&quot;</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">IntanRHXDevice</span><span class="p">()</span>
<span class="n">config_options</span><span class="o">.</span><span class="n">set_channel</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">CHANNEL_INDEX</span><span class="p">,</span> <span class="n">enable_wide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Streaming data...&quot;</span><span class="p">)</span>
<span class="n">timestamps</span><span class="p">,</span> <span class="n">voltages</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">duration_sec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">voltages</span> <span class="o">=</span> <span class="n">voltages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Use the single channel directly</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Client data collection complete.&quot;</span><span class="p">)</span>
<span class="n">device</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># --- 2. Load same channel from RHD file ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading RHD file...&quot;</span><span class="p">)</span>
<span class="n">RHD_PATH</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;PATH/TO/YOUR_FILE.rhd&quot;</span>  <span class="c1"># &lt;-- Update this path as needed</span>
<span class="n">rhd_result</span> <span class="o">=</span> <span class="n">load_rhd_file</span><span class="p">(</span><span class="n">RHD_PATH</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of emg data: </span><span class="si">{</span><span class="n">rhd_result</span><span class="p">[</span><span class="s1">&#39;amplifier_data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">rhd_data</span> <span class="o">=</span> <span class="n">rhd_result</span><span class="p">[</span><span class="s2">&quot;amplifier_data&quot;</span><span class="p">][</span><span class="n">CHANNEL_INDEX</span><span class="p">,</span> <span class="p">:</span><span class="n">SAMPLES_TO_COMPARE</span><span class="p">]</span>
<span class="n">fs_rhd</span> <span class="o">=</span> <span class="n">rhd_result</span><span class="p">[</span><span class="s2">&quot;frequency_parameters&quot;</span><span class="p">][</span><span class="s2">&quot;amplifier_sample_rate&quot;</span><span class="p">]</span>
<span class="n">ts_rhd</span> <span class="o">=</span> <span class="n">rhd_result</span><span class="p">[</span><span class="s2">&quot;t_amplifier&quot;</span><span class="p">][:</span><span class="n">SAMPLES_TO_COMPARE</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RHD file sampling rate: </span><span class="si">{</span><span class="n">fs_rhd</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

<span class="c1"># --- 3. Plot both signals ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts_rhd</span><span class="p">,</span> <span class="n">rhd_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RHD File&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">voltages</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Live TCP&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Channel </span><span class="si">{</span><span class="n">CHANNEL_INDEX</span><span class="si">}</span><span class="s2"> — First </span><span class="si">{</span><span class="n">SAMPLES_TO_COMPARE</span><span class="si">}</span><span class="s2"> Samples&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude (µV)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<hr class="docutils" />
<p><strong>Expected outcome:</strong></p>
<ul class="simple">
<li><p>Both traces should overlap closely (after any expected delays or offsets), demonstrating that your live data stream matches what is saved to file.</p></li>
<li><p>Terminal output will confirm data shape and sampling rate.</p></li>
</ul>
<p><strong>Tips:</strong>
- Use the same channel and sampling rate for both streaming and file loading.
- Update the <cite>RHD_PATH</cite> variable with the path to your <cite>.rhd</cite> file.
- Adjust <cite>SAMPLES_TO_COMPARE</cite> and <cite>CHANNEL_INDEX</cite> as needed for your test.</p>
<p><strong>Troubleshooting:</strong>
- Ensure the RHX TCP server is running and enabled.
- Check for any timing mismatches, which may arise if the file and stream are not started simultaneously.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="live_plotting.html" class="btn btn-neutral float-left" title="Live Plotting of Multiple EMG Channels" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../intan_api/modules.html" class="btn btn-neutral float-right" title="intan" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jonathan Shulgach.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>